<!--
THIS PAGE EXPECTS TO FIND D3 AT docroot/D3/d3.d3.v3.min.js.
IT ALSO EXPECTS THE DATA.JS FILE FROM THE PYTHON SCRIPT IN THE SAME PLACE.

THIS IS JUST TO AVOID CONFUSION AS TO SOME OF THE PATHS.
BUT, MINOR TWEAKS MAY STILL BE NEEDED.

STILL TO DO:
HIGHLIGHT A TEAM ON ALL GRAPHS ON MOUSEOVER
TEAM EXCLUSION LIST, PREFEREABLY DYNAMICALLY
-->

<html>
<head>
	<style type="text/css">
		.chart rect {
			stroke: white;
			fill: steelblue;
		}
	</style>
	<script type="text/javascript" src="/D3/d3.v3.min.js"></script>
	<title>D3 Display</title>
</head>
<body>
<table><tr><td id="viz0"></td><td id="viz1"></td></tr><tr><td id="viz2"></td><td id="viz3"></td></tr></table>

<script type="text/javascript">
var q;
var qualmax = 0;
var qpmax = 0;
var pointmax = 0;

var datasize;

d3.json("/D3/data.js", function(error, json){
	if (error) return console.warn(error);
	datasize = json.length;

	q = json;

var w = 600;
var h = 340;

	q.sort(function(a,b){
		if (a[2] > qualmax) qualmax = a[2];
		if (b[2] > qualmax) qualmax = b[2];

		if (a[2] > b[2]) return -1;
		if (a[2] < b[2]) return 1;
		if (a[2] == b[2]){
			if (a[3] > b[3]) return -1;
			if (a[3] < b[3]) return 1;
		} else {
			return 0;
		}
	});

var graph1 = d3.select("#viz1").append("svg")
	.attr("class", "chart")
	.attr("width", w)
	.attr("height", h);

graph1.selectAll("rect")
	.data(q)
	.enter().append("rect")
	.attr("x", function(d,i){ return i*w/datasize; })
	.attr("y", function(d){ return h-(d[2]/qualmax*h); })
	.attr("width", w/datasize)
	.attr("height", function(d){ return (d[2]/qualmax*h); });
graph1.selectAll("text")
	.data(q)
	.enter().append("text")
	.text(function(d){ return d[0]; })
	.attr("text-anchor", "end")
	.attr("transform", function(d,i){ return "translate("+(i*w/datasize+12).toString()+","+(h-(d[2]/qualmax*h)+3).toString()+")rotate(-90)"; });

	q.sort(function(a,b){
		if (a[2] > qpmax) qpmax = a[2];
		if (b[2] > qpmax) qpmax = b[2];

		if (a[2] > b[2]) return -1;
		if (a[2] < b[2]) return 1;
		if (a[2] == b[2]){
			if (a[1] > b[1]) return -1;
			if (a[1] < b[1]) return 1;
		} else {
			return 0;
		}
	});

var graph2 = d3.select("#viz2").append("svg")
	.attr("class", "chart")
	.attr("width", w)
	.attr("height", h);

graph2.selectAll("rect")
	.data(q)
	.enter().append("rect")
	.attr("x", function(d,i){ return i*w/datasize; })
	.attr("y", function(d){ return h-(d[2]/qpmax*h); })
	.attr("width", w/datasize)
	.attr("height", function(d){ return (d[2]/qpmax*h); });
graph2.selectAll("text")
	.data(q)
	.enter().append("text")
	.text(function(d){ return d[0]; })
	.attr("text-anchor", "end")
	.attr("transform", function(d,i){ return "translate("+(i*w/datasize+12).toString()+","+(h-(d[2]/qpmax*h)+3).toString()+")rotate(-90)"; });


	q.sort(function(a,b){
		if (a[1] > pointmax) pointmax = a[1];
		if (b[1] > pointmax) pointmax = b[1];

		if (a[1] > b[1]) return -1;
		if (a[1] < b[1]) return 1;
		if (a[1] == b[1]) return 0;
	});

var graph3 = d3.select("#viz0").append("svg")
	.attr("class", "chart")
	.attr("width", w)
	.attr("height", h);

graph3.selectAll("rect")
	.data(q)
	.enter().append("rect")
	.attr("x", function(d,i){ return i*w/datasize; })
	.attr("y", function(d){ return h-(d[1]/pointmax*h); })
	.attr("width", w/datasize)
	.attr("height", function(d){ return (d[1]/pointmax*h); });
graph3.selectAll("text")
	.data(q)
	.enter().append("text")
	.text(function(d){ return d[0]; })
	.attr("text-anchor", "end")
	.attr("transform", function(d,i){ return "translate("+(i*w/datasize+12).toString()+","+(h-(d[1]/pointmax*h)+3).toString()+")rotate(-90)"; });
});

</script>
</body>
</html>